# Claude Codeへの指示書：学級経営案 年間単元指導計画 作成ツール

## ◆ このファイルについて
このファイルはClaude Codeへの指示書です。
以下の内容をフェーズごとに指示してください。
一度に全部ではなく、フェーズ1から順番に進めてください。

---

## ◆ プロジェクト概要

小学校の先生向けの「年間単元指導計画表」作成Webアプリを、**1つのHTMLファイル**で作ってください。

### 利用シーン
- 小学校の先生が年3回（4月・9月・1月）、学級経営案の一部として年間単元指導計画表を更新する
- 学年を選ぶと単元データが自動配置され、編集して矢印を引いてPDF出力する
- 保存/読み込みはJSONファイルで行う（サーバー不要）

### 技術要件
- **単一HTMLファイル**で完結すること（外部サーバー不要）
- ブラウザで開くだけで動くこと（Chrome推奨）
- 外部ライブラリはCDNから読み込み可
- 日本語UI

---

## ◆ フェーズ1：基本の表を作る

### Claude Codeへの指示（これをコピペ）

```
このフォルダにある curriculum_data.json を読んでください。
小学校1〜6年生の全教科の単元データが入っています。

これを使って、年間単元指導計画表を作成するWebアプリを1つのHTMLファイルで作ってください。

【画面構成】
- 上部にツールバー：学年選択ドロップダウン（1〜6年）、保存ボタン、読み込みボタン、PDF出力ボタン
- メインエリアに表を表示

【表の構造】
- 縦軸：月（4月〜3月の12行）
- 横軸：教科（curriculum_data.jsonに含まれる教科を全て列として表示）
- 各セルに「単元名（時間数）」を表示
- 1つの月に複数単元がある場合は、セル内で改行して全て表示
- 各教科の最下行に年間合計時数を表示

【書式】
- タイトル行：「令和7年度 第○学年 年間単元指導計画表」（学年は選択に連動）
- 学期ごとに行の背景色を分ける
  - 1学期（4月〜7月）：薄い青 #E8F0FE
  - 2学期（9月〜12月）：薄い黄 #FFF8E1
  - 3学期（1月〜3月）：薄い緑 #E8F5E9
  - 8月は薄いグレー #F5F5F5
- フォント：游ゴシック or sans-serif、サイズ小さめ（11px程度）
- 表全体をA3横向きの比率に合わせる

【学年選択の動作】
- ドロップダウンで学年を変えると、curriculum_data.jsonからその学年のデータを読み込んで表を再描画
- その学年に存在しない教科の列は非表示にする（例：1年生に社会はない）

curriculum_data.json のデータをHTMLファイル内にJavaScriptの変数として埋め込んでください。
```

---

## ◆ フェーズ2：セル編集機能を追加

### Claude Codeへの指示

```
表のセルをクリックしたら編集できるようにしてください。

【編集機能の仕様】
- セルをクリックするとモーダル（小さな編集ウィンドウ）が開く
- モーダルには以下を表示：
  - そのセルに入っている単元の一覧（各単元ごとに「単元名」テキスト欄と「時数」数値欄）
  - 「単元を追加」ボタン（新しい単元行を追加）
  - 各単元に「削除」ボタン
  - 「保存」「キャンセル」ボタン
- 編集結果は表にすぐ反映される
- 年間合計時数も自動で再計算される
```

---

## ◆ フェーズ3：矢印機能を追加

### Claude Codeへの指示

```
単元同士を矢印で結ぶ機能を追加してください。

【矢印機能の仕様】
- ツールバーに「矢印モード」トグルボタンを追加
- 矢印モードONの時：
  1. セル内の単元名をクリックすると「始点」として選択される（ハイライト表示）
  2. 別のセルの単元名をクリックすると「終点」として確定
  3. 始点から終点へSVGで矢印線を描画する
- 矢印モードOFFの時：通常の編集モード
- 矢印の見た目：
  - 線の色：赤（#D32F2F）、太さ2px
  - 先端に三角の矢じり
  - セルの中央あたりから出て、終点セルの中央あたりに到達
- 矢印を右クリックまたはダブルクリックで削除できる
- 表の上にSVGレイヤーをoverlay配置し、スクロールに追従する

【矢印の用途】
先生たちは以下のような関連を示すために矢印を使います：
- 同じ教科で前月の単元から今月の単元への継続
- 教科横断的な関連（例：社会の歴史単元と国語の古典単元）
```

---

## ◆ フェーズ4：保存/読み込み機能

### Claude Codeへの指示

```
保存と読み込み機能を実装してください。

【保存機能】
- 「保存」ボタンを押すとJSONファイルがダウンロードされる
- ファイル名は自動で「学級経営案_5年_2026-04-10.json」のような形式
- JSONに含める情報：
  - 学年
  - 保存日時
  - 全セルの単元データ（編集済みの内容）
  - 矢印の接続情報（始点と終点の座標または単元ID）
  - メモ欄の内容（もしあれば）

【読み込み機能】
- 「読み込み」ボタンを押すとファイル選択ダイアログが開く
- JSONファイルを選択すると、保存時の状態が完全に復元される
  - 学年選択が切り替わる
  - 表の内容が復元される
  - 矢印も全て再描画される

【注意】
- 読み込み時に「現在の編集内容が失われますが、よろしいですか？」の確認ダイアログを出す
- 不正なJSONファイルを選択した場合はエラーメッセージを表示
```

---

## ◆ フェーズ5：PDF出力

### Claude Codeへの指示

```
PDF出力機能を実装してください。

【PDF出力の仕様】
- 「PDF出力」ボタンを押すとA3横向きのPDFとして出力
- window.print() を使い、@media print のCSSで制御する方式でOK
- 印刷時の設定：
  - ツールバーは非表示
  - 表だけが印刷される
  - 矢印もそのまま印刷される
  - A3横向き（420mm x 297mm）に収まるよう自動縮小
  - 余白は最小限
- ブラウザの印刷ダイアログで「PDFとして保存」を選べば保存できる旨、ボタンの横に小さく注記を表示
```

---

## ◆ フェーズ6：抽出版ビュー（自己実現活動＋関連単元）

### Claude Codeへの指示

```
「抽出版」表示機能を追加してください。

【概要】
ツールバーに「抽出版を表示」トグルボタンを追加します。
ONにすると、通常の全教科表示から切り替わり、
「自己実現活動」と、そこに矢印で結ばれている単元だけを表示する抽出ビューになります。

【抽出版の表示ルール】
- 縦軸（月）はそのまま4月〜3月
- 横軸は以下のように変わる：
  - 左側に「自己実現活動」の列を固定表示
  - その右側に、矢印で自己実現活動と接続されている単元を持つ教科だけを列として表示
  - 矢印が結ばれていない教科の列は非表示
- 矢印で接続されている単元のセルだけを表示し、接続されていない単元のセルは空欄にする
- 矢印はそのまま表示する（自己実現活動に関連するもののみ）

【具体例】
たとえば、自己実現活動の「竹の子祭(4月)」に矢印で
体育の「表現(竹の子祭)(5月)」と図画工作の「キッズフェスティバルをつくろう(5月)」が
結ばれている場合：
- 表には「自己実現活動」「体育」「図画工作」の3列だけが表示される
- 体育列の5月に「表現(竹の子祭)」、図画工作列の5月に「キッズフェスティバル…」が表示
- それ以外の体育・図画工作の単元は表示されない

【UI/UXの仕様】
- 「抽出版を表示」ボタンはトグル式（もう一度押すと全体表示に戻る）
- 抽出版の時はタイトルが「令和7年度 第○学年 年間単元指導計画表【抽出版：自己実現活動】」に変わる
- 抽出版の状態でもPDF出力できる（抽出版のままA3で出力される）
- 抽出版の状態でも矢印の追加・削除は可能
- 背景色は通常版と変えて、自己実現活動の列を薄いオレンジ（#FFF3E0）で強調する

【保存への影響】
- 抽出版はあくまで「表示の切り替え」なので、保存データには影響しない
- JSONにはどのビューで表示していたかを保存しなくてよい（読み込み時は常に全体表示で開く）
```

---

## ◆ データファイルについて

curriculum_data.json がこのフォルダに入っています。
このJSONの構造は以下のとおりです：

```json
{
  "1": {           // 学年（1〜6）
    "国語": [      // 教科名
      {
        "unit": "春が来た",     // 単元名
        "month": 4,             // 指導月（4〜3、0は未定）
        "hours": 2              // 配当時数
      },
      ...
    ],
    "算数": [...],
    ...
  },
  "2": { ... },
  ...
}
```

---

## ◆ 進め方のコツ

1. **フェーズ1から順番に**やってください。全部一度に指示すると複雑になりすぎます
2. 各フェーズが終わったら**ブラウザで開いて動作確認**してから次に進んでください
3. うまくいかない部分は「〇〇が動きません、修正してください」と伝えれば直してくれます
4. フェーズごとに「ここまでのHTMLを上書き保存して」と伝えてください
